# üß† Dr. House Chatbot (LLaMA3 fine-tuned)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç-–±–æ—Ç –≤ —Å—Ç–∏–ª–µ –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `LLaMA 3`, —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π.

![Chatbot Screenshot](reports/screenshot.png)
---

üí¨ –ü—Ä–∏–º–µ—Ä –¥–∏–∞–ª–æ–≥–∞ —Å –º–æ–¥–µ–ª—å—é:
üß† I'm Dr. House. Let's get this over with.

üë© Hello doc  
üß† Hello. So, you're the guy that's been screwing with the team for months, but you're not willing to admit that you're wrong.

üë© I have chest pain. Should I be worried?  
üß† No. I'm sure you'll be back to your normal self in a few hours. You've got a good heart.

üë© It started after I climbed the stairs. Is it serious?  
üß† It's a classic symptom of pulmonary embolism. You're in the clear. Just take some aspirin and go back to your normal self.

üë© I also feel short of breath. What could it be?  
üß† Start her on IV heparin. We'll get her back on track in no time.

üë© My father had a heart attack at 50. Is this genetic?  
üß† I don't know. It's not the heart. It's the lungs.

üë© Can I take aspirin to help?  
üß† That's the spirit. Let's get you back on track.

üë© Will you order any tests?  
üß† You're welcome. I'm going to go get...

üë© What do you think it is?  
üß† It's a pulmonary embolism. Just like that.

üë© Could it be just anxiety?  
üß† No. It's a classic symptom of pulmonary embolism.

üë© Should I go to the ER?  
üß† If you feel any pain, get out of there. You'll be back in two days.

üë© Are you going to help me or just be sarcastic?  
üß† I'm going to help you. And when you're back on track, you'll be back on track.


## üß† –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Gradio web-—Å–µ—Ä–≤–∏—Å

–ú–æ–¥–µ–ª—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∫–∞–∫ —á–∞—Ç-–±–æ—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Gradio.  
–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `.queue()`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

–§–∞–π–ª –∑–∞–ø—É—Å–∫–∞: `models_inferences/inference_gradio_async.py`

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `type="messages"` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å—Ç–∏–ª–µ OpenAI
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `gr.State(...)` –∫–∞–∫ —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–ª–∏–∫ —Å —Ä–æ–ª—è–º–∏
- –û—Ç–≤–µ—Ç—ã –•–∞—É—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–µ–∑–∞—é—Ç—Å—è –ø–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º 2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º (—É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è `.`, `!`, `?`)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π: `max_tokens`, `temperature`, `top_p`
- –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –¥–ª–∏–Ω–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ—Å—Ç–∏

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `demo.queue().launch(share=True)`

‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `inference_gradio_async.py` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ä—Å–∏—é web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞:
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—á–µ—Ä–µ–¥—å
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞
- –ª—É—á—à–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏ —Å—Ç–∏–ª–µ–º

## ü§ñ –û–±–∑–æ—Ä –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞

–í —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –∏ –¥–æ–æ–±—É—á–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π —Å —Ü–µ–ª—å—é —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

### üî¨ –ú–æ–¥–µ–ª—å 1: `housemd-chatbot-llama3-lora`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `unsloth/Llama-3.2-1B-Instruct`
- **–§–æ—Ä–º–∞—Ç:** SFT (—Ä—É—á–Ω–æ–π prompt, –±–µ–∑ chat_template)
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è:** QLoRA (4-bit)
- **–ü–ª—é—Å—ã:**
  - –í—ã–¥–∞—ë—Ç –∫–æ–ª–∫–∏–µ, –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
  - –•–æ—Ä–æ—à–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å—Ç–∏–ª—å –•–∞—É—Å–∞
  - –£—Å—Ç–æ–π—á–∏–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Colab, –±—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **–ú–∏–Ω—É—Å—ã:**
  - –ò–Ω–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –Ω–∞—Ä—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∫–∏
  - –ü–æ–≤—Ç–æ—Ä—ã –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

### üî¨ –ú–æ–¥–µ–ª—å 2: `housemd-chatbot-llama3-v3_ext`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `openlm-research/open_llama_3b_v2` (‚âà3B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- **–§–æ—Ä–º–∞—Ç:** SFT, anchor ‚Üí response
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è:** LoRA –Ω–∞ q_proj/v_proj, –±–µ–∑ chat_template
- **–ü–ª—é—Å—ã:**
  - –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - –í—ã—à–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã–≤–æ–¥–∞ –ø—Ä–∏ –±–æ–ª—å—à–µ–π –≥–ª—É–±–∏–Ω–µ –º–æ–¥–µ–ª–∏
  - –†–∞–±–æ—Ç–∞–µ—Ç —Å 8-bit –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–µ–π –≤ Colab
- **–ú–∏–Ω—É—Å—ã:**
  - –û—Ç–≤–µ—á–∞–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–º –Ω–∞ –≤–æ–ø—Ä–æ—Å
  - –ü–æ—Ç–µ—Ä—è —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–∏ –±–µ–∑ –∂—ë—Å—Ç–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è

### üî¨ –ú–æ–¥–µ–ª—å 3: `housemd-chatbot-llama3-lora_v3_ext_chat_template`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** `unsloth/Llama-3.2-1B-Instruct`
- **–§–æ—Ä–º–∞—Ç:** SFT —Å `chat_template`
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è:** QLoRA + LoRA
- **–ü–ª—é—Å—ã:**
  - –ß—ë—Ç–∫–∏–π —Å—Ç–∏–ª—å –•–∞—É—Å–∞: —Å–∞—Ä–∫–∞–∑–º, –∫—Ä–∞—Ç–∫–æ—Å—Ç—å, –ª–æ–≥–∏–∫–∞
  - –û–±—Ä–µ–∑–∫–∞ –ø–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ Gradio `type="messages"`
- **–ú–∏–Ω—É—Å—ã:**
  - –ú–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä—ã —Ñ—Ä–∞–∑ (–≤ —Ä–∞–º–∫–∞—Ö –æ–±—Ä–∞–∑–∞)
  - –¢—Ä–µ–±—É–µ—Ç —á—ë—Ç–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ prompt

### üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π               | llama3-lora_v3_ext_chat_template | llama3-lora               | llama3-v3_ext (3B)       |
|------------------------|-----------------------------------|----------------------------|--------------------------|
| –°—Ç–∏–ª—å –•–∞—É—Å–∞            | ‚úÖ‚úÖ‚úÖ                               | ‚úÖ‚úÖ                        | ‚úÖ                       |
| –ö—Ä–∞—Ç–∫–æ—Å—Ç—å              | ‚úÖ‚úÖ‚úÖ                               | ‚úÖ‚úÖ                        | ‚ö†Ô∏è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–≤–æ–¥–∞)     |
| –õ–æ–≥–∏—á–Ω–æ—Å—Ç—å             | ‚úÖ‚úÖ                                | ‚ö†Ô∏è                         | ‚úÖ‚úÖ                     |
| –ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏           | ‚ö†Ô∏è                                 | ‚ö†Ô∏è                         | ‚ö†Ô∏è‚ö†Ô∏è                     |
| –°–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏     | 5‚Äì6 —Ç–æ–∫–µ–Ω–æ–≤/—Å–µ–∫                    | 6‚Äì8 —Ç–æ–∫–µ–Ω–æ–≤/—Å–µ–∫            | 3‚Äì4 —Ç–æ–∫–µ–Ω–∞/—Å–µ–∫           |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ chat_template| ‚úÖ                                 | ‚ùå                         | ‚ùå                       |

### ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
–î–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞ —Å –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º–∏, —Ä–µ–∑–∫–∏–º–∏ –∏ —É–∑–Ω–∞–≤–∞–µ–º—ã–º–∏ —Ä–µ–ø–ª–∏–∫–∞–º–∏ –≤ –¥—É—Ö–µ –ì—Ä–µ–≥–æ—Ä–∏ –•–∞—É—Å–∞ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –º–æ–¥–µ–ª—å:

**`housemd-chatbot-llama3-lora_v3_ext_chat_template`**

–û–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é;
- —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å;
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —á–∞—Ç–∞ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç–≤–µ—Ç–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

chatbot_dr.house_v.2.0/
‚îú‚îÄ‚îÄ assets/                          # –ê–≤–∞—Ç–∞—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ Dr. House.png
‚îÇ   ‚îî‚îÄ‚îÄ user.jpg
‚îÇ
‚îú‚îÄ‚îÄ data/                            # –î–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ questions_answers.csv
‚îÇ   ‚îî‚îÄ‚îÄ questions_answers_new.csv
‚îÇ
‚îú‚îÄ‚îÄ models_inferences/              # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å—ã –∏ web-—Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ inference.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ inference_gradio.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ inference_gradio_async.py         # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Gradio web-—Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ inference_gradio_chat_template.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ inferences_(models_comparison).ipynb  # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ models_training/                # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ data_preparing.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ train_openlm_research_open_llama_3b_v2_v3_ext.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ train_unsloth_Llama_3_2_1B.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ train_unsloth_Llama_3.2-1B-Instruct_v1_ext_chat_template.ipynb
‚îÇ
‚îú‚îÄ‚îÄ reports/                        # –û—Ç—á—ë—Ç—ã –∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ Screenshot.png
‚îÇ   ‚îî‚îÄ‚îÄ –û—Ç—á–µ—Ç —á–∞—Ç–±–æ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞ 2.0.pdf
‚îÇ
‚îú‚îÄ‚îÄ app.py                          # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md

---

## üèóÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- ü§ñ **–ú–æ–¥–µ–ª–∏:** `open_llama_3b_v2`, `unsloth/Llama-3.2-1B-Instruct` + `LoRA` + `QLoRA`
- üß† **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏:** `Transformers`, `PEFT`, `trl`, `Gradio`
- üìä **–î–∞–Ω–Ω—ã–µ:** —Å–æ–±—Ä–∞–Ω—ã –≤—Ä—É—á–Ω—É—é, —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–¥ —Å—Ç–∏–ª—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –•–∞—É—Å–∞
- ‚öôÔ∏è **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å:** —Å —Ä—É—á–Ω—ã–º prompt'–æ–º (–≤ —Å—Ç–∏–ª–µ chat_template)
- üìà **–ú–µ—Ç—Ä–∏–∫–∏:** —Å–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Å—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–≤—Ç–æ—Ä–æ–≤ –∏ —Å–∞—Ä–∫–∞–∑–º–∞

---

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å—Ç–∏–ª–µ –ì—Ä–µ–≥–æ—Ä–∏ –•–∞—É—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è: SFT, chat-style
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–∏–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
- Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Gradio —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏
- –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç—Ä–∏–º–º–∏–Ω–≥ –ø–æ –≤—Ç–æ—Ä–æ–π —Ç–æ—á–∫–µ/–≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º—É/–≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–º—É –∑–Ω–∞–∫—É
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ QLoRA –∏ low-RAM –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
python models_inferences/inference_gradio_async.py
```

---

## üß™ –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–µ–π

–ò–Ω—Ñ–µ—Ä–µ–Ω—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö:
- `generate_house_response()` ‚Äî —á–µ—Ä–µ–∑ —Ä—É—á–Ω–æ–π –ø—Ä–æ–º–ø—Ç (–≤ —Å—Ç–∏–ª–µ chat-template)
- `setup_chat_format()` ‚Äî —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `chat_template` HuggingFace (–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏)

–ü—Ä–æ–º–ø—Ç—ã –∑–∞–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ–¥–µ–ª–∏.


## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
–ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ 3 –ø–æ–¥—Ö–æ–¥–æ–≤:

| –ú–æ–¥–µ–ª—å                          | –°—Ç–∏–ª—å             | –ö–æ–Ω—Ç—Ä–æ–ª—å | –°–∫–æ—Ä–æ—Å—Ç—å | –ò—Ç–æ–≥                  |
|--------------------------------|-------------------|----------|----------|------------------------|
| open_llama_3b_v2               | —Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–π    | —á–∞—Å—Ç–∏—á–Ω—ã–π| ‚úÖ       | –±–∞–∑–æ–≤–∞—è, –±–µ–∑ —Å—Ç–∏–ª—è     |
| housemd-chatbot-llama3-lora    | —Ä–µ–∑–∫–∏–π –∏ –∫—Ä–∞—Ç–∫–∏–π  | –ø–æ–ª–Ω—ã–π   | ‚úÖ‚úÖ      | –±–ª–∏–∂–µ –∫ –•–∞—É—Å—É          |
| housemd-chatbot-llama3-v3_ext  | –≥–ª–∞–¥–∫–∏–π –∏ —Å–≤—è–∑–Ω—ã–π | —á–∞—Å—Ç–∏—á–Ω—ã–π| ‚úÖ‚úÖ‚úÖ    | –ª—É—á—à–µ –¥–ª—è —á–∞—Ç–∞         |

---

## üìå –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```
üì® User: Can I take painkillers?
üß† Dr. House: They'll make you feel a little better, but they'll also make you feel a lot worse.
```

---

## üìé –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–¥–∞–Ω–∏—é

### ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π web-—Å–µ—Ä–≤–∏—Å
- –ú–æ–¥–µ–ª—å —É–ø–∞–∫–æ–≤–∞–Ω–∞ –≤ Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å [`inference_gradio_async.py`](models_inferences/inference_gradio_async.py), —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ (`async def`).
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –º–æ–∂–Ω–æ –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫.

---

### ‚úÖ –ú–µ—Ç–æ–¥—ã –ø–æ–≤—ã—à–µ–Ω–∏—è —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤:

| –ú–µ—Ç–æ–¥                   | –û–ø–∏—Å–∞–Ω–∏–µ                                                               | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                |
|------------------------|------------------------------------------------------------------------|-------------------------------------------|
| üîç –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞        | –û–±—Ä–µ–∑–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º (., !, ?)                    | `clean_response()`                        |
| üìö –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–π –≤–≤–æ–¥ | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∞–∫—Ç—ã –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ –≤ prompt                 | –ß–µ—Ä–µ–∑ —Ä—É—á–Ω–æ–π prompt –≤ `Gradio`            |
| üß† –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –≤—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ                         | `num_return_sequences + —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞`      |
| ü§ñ –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–æ–≥–∏–∫–∏      | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Ç–∏–ø–∞ ‚ÄúDoes it make sense?‚Äù (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ) | –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞                   |

---



## üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [`inference_gradio_async.py`](models_inferences/inference_gradio_async.py) ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
- [`–û—Ç—á–µ—Ç —á–∞—Ç–±–æ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞ 2.0.pdf`](reports/–û—Ç—á–µ—Ç%20—á–∞—Ç–±–æ—Ç%20–¥–æ–∫—Ç–æ—Ä–∞%20–•–∞—É—Å–∞%202.0.pdf) ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏, –≥—Ä–∞—Ñ–∏–∫–∞–º–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π.
- [`inferences_(models_comparison).ipynb`](models_inferences/inferences_(models_comparison).ipynb) ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–∏ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞.
