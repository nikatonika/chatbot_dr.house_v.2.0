# üß† Dr. House Chatbot (LLaMA3 fine-tuned)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç-–±–æ—Ç –≤ —Å—Ç–∏–ª–µ –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `LLaMA 3`, —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

chatbot_dr.house_v.2.0/ 
chatbot_dr.house_v.2.0/
‚îú‚îÄ‚îÄ assets/                        # –ê–≤–∞—Ç–∞—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ Dr. House.png
‚îÇ   ‚îî‚îÄ‚îÄ user.jpg
‚îÇ
‚îú‚îÄ‚îÄ data/                          # –î–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ questions_answers.csv
‚îÇ   ‚îî‚îÄ‚îÄ questions_answers_new.csv
‚îÇ
‚îú‚îÄ‚îÄ models_inferences/            # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ inference.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ inference_gradio.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ inference_gradio_async.py   # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Gradio web-—Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îî‚îÄ‚îÄ inferences_(models_comparison).ipynb
‚îÇ
‚îú‚îÄ‚îÄ models_training/              # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ data_preparing.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ train_openlm_research_open_llama_3b_v2.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ train_unsloth_Llama_3_2_1B.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ train_unsloth_Llama-3.2-1B-lora_chat_template.ipynb
‚îÇ
‚îú‚îÄ‚îÄ reports/
‚îÇ   ‚îî‚îÄ‚îÄ –û—Ç—á–µ—Ç —á–∞—Ç–±–æ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞ 2.0.pdf
‚îÇ
‚îú‚îÄ‚îÄ app.py                        # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª


---

## üèóÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- ü§ñ **–ú–æ–¥–µ–ª–∏:** `open_llama_3b_v2`, `unsloth/Llama-3.2-1B-Instruct` + `LoRA` + `QLoRA`
- üß† **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏:** `Transformers`, `PEFT`, `trl`, `Gradio`
- üìä **–î–∞–Ω–Ω—ã–µ:** —Å–æ–±—Ä–∞–Ω—ã –≤—Ä—É—á–Ω—É—é, —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–¥ —Å—Ç–∏–ª—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –•–∞—É—Å–∞
- ‚öôÔ∏è **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å:** —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º prompt'–æ–º –∏–ª–∏ `chat_template`
- üìà **–ú–µ—Ç—Ä–∏–∫–∏:** —Å–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Å—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–≤—Ç–æ—Ä–æ–≤ –∏ —Å–∞—Ä–∫–∞–∑–º–∞

---

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å—Ç–∏–ª–µ –ì—Ä–µ–≥–æ—Ä–∏ –•–∞—É—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è: SFT, chat-template
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–∏–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
- Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Gradio —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏
- –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç—Ä–∏–º–º–∏–Ω–≥ –ø–æ –≤—Ç–æ—Ä–æ–π —Ç–æ—á–∫–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ QLoRA –∏ low-RAM –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt


# –ó–∞–ø—É—Å–∫ Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
python models_inferences/inference_gradio.ipynb
üß™ –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–µ–π
–ò–Ω—Ñ–µ—Ä–µ–Ω—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö:

generate_house_response() ‚Äî —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç

setup_chat_format() ‚Äî —á–µ—Ä–µ–∑ chat_template HuggingFace

–ü—Ä–æ–º–ø—Ç—ã –∑–∞–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–æ–¥–µ–ª–∏.

üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
–ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ 3 –ø–æ–¥—Ö–æ–¥–æ–≤:

–ú–æ–¥–µ–ª—å	–°—Ç–∏–ª—å	–ö–æ–Ω—Ç—Ä–æ–ª—å	–°–∫–æ—Ä–æ—Å—Ç—å	–ò—Ç–æ–≥
open_llama_3b_v2	—Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–π	—á–∞—Å—Ç–∏—á–Ω—ã–π	‚úÖ	–±–∞–∑–æ–≤–∞—è, –±–µ–∑ —Å—Ç–∏–ª—è
housemd-chatbot-llama3-lora	—Ä–µ–∑–∫–∏–π –∏ –∫—Ä–∞—Ç–∫–∏–π	–ø–æ–ª–Ω—ã–π	‚úÖ‚úÖ	–±–ª–∏–∂–µ –∫ –•–∞—É—Å—É
housemd-chatbot-llama3-v3_ext_chat	–≥–ª–∞–¥–∫–∏–π –∏ —Å–≤—è–∑–Ω—ã–π	—á–∞—Å—Ç–∏—á–Ω—ã–π	‚úÖ‚úÖ‚úÖ	–ª—É—á—à–µ –¥–ª—è —á–∞—Ç–∞
üìå –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
text
Copy
Edit
üì® User: Can I take painkillers?
üß† Dr. House: They'll make you feel a little better, but they'll also make you feel a lot worse.


---

## üìé –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–¥–∞–Ω–∏—é

### ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π web-—Å–µ—Ä–≤–∏—Å
- –ú–æ–¥–µ–ª—å —É–ø–∞–∫–æ–≤–∞–Ω–∞ –≤ Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å [`inference_gradio_async.py`](models_inferences/inference_gradio_async.py), —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ (`async def`).
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –º–æ–∂–Ω–æ –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫.

---

### ‚úÖ –ú–µ—Ç–æ–¥—ã –ø–æ–≤—ã—à–µ–Ω–∏—è —Ñ–∞–∫—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤:

| –ú–µ—Ç–æ–¥                           | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                  |
|--------------------------------|--------------------------------------------------------------------------|---------------------------------------------|
| üîç –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞                | –û–±—Ä–µ–∑–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ –≤—Ç–æ—Ä–æ–π —Ç–æ—á–∫–µ –¥–ª—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π –º—ã—Å–ª–∏                     | `generate_house_response()`                |
| üìö –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–π –≤–≤–æ–¥         | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∞–∫—Ç—ã –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ –≤ prompt                  | –ß–µ—Ä–µ–∑ —Ä—É—á–Ω–æ–π prompt –≤ `Gradio`             |
| üß† –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤         | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –≤—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)             | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—Ç—å `num_return_sequences`  |
| ü§ñ –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–æ–≥–∏–∫–∏              | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Ç–∏–ø–∞ ‚ÄúDoes it make sense?‚Äù (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ) | –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞                    |

---

### üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [`inference_gradio_async.py`](models_inferences/inference_gradio_async.py) ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
- [`–û—Ç—á–µ—Ç —á–∞—Ç–±–æ—Ç –¥–æ–∫—Ç–æ—Ä–∞ –•–∞—É—Å–∞ 2.0.pdf`](reports/–û—Ç—á–µ—Ç%20—á–∞—Ç–±–æ—Ç%20–¥–æ–∫—Ç–æ—Ä–∞%20–•–∞—É—Å–∞%202.0.pdf) ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏, –≥—Ä–∞—Ñ–∏–∫–∞–º–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π.
- [`inferences_(models_comparison).ipynb`](models_inferences/inferences_(models_comparison).ipynb) ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–∏ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞.
